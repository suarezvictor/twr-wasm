(()=>{var t,e,r,s;let o;Object.defineProperty({},"twrWasmModuleAsyncProxy",{get:()=>O,set:void 0,enumerable:!0,configurable:!0});class n{mod;constructor(t){this.mod=t}atod(t,e){let r=this.mod.getString(t,e),s=r.trimStart().toUpperCase();return"INF"==s||"+INF"==s||"INFINITY"==s||"+INFINITY"==s?Number.POSITIVE_INFINITY:"-INF"==s||"-INFINITY"==s?Number.NEGATIVE_INFINITY:Number.parseFloat(r.replaceAll("D","e").replaceAll("d","e"))}dtoa(t,e,r,s){if(-1==s){let s=r.toString();this.mod.copyString(t,e,s)}else{let o=r.toString();o.length>s&&(o=r.toPrecision(s)),this.mod.copyString(t,e,o)}}toFixed(t,e,r,s){let o=r.toFixed(s);this.mod.copyString(t,e,o)}toExponential(t,e,r,s){let o=r.toExponential(s);this.mod.copyString(t,e,o)}fcvtS(t,e,r,s,o,n){let i,a;if(0==t||0==n||0==o||e<1)return 1;let l=0;if(Number.isNaN(r))i="1#QNAN00000000000000000000000000000".slice(0,s+1),a=1;else if(Number.isFinite(r)){if(0==r)i="000000000000000000000000000000000000".slice(0,s),a=0;else{if(r<0&&(l=1,r=Math.abs(r)),s>100||r>1e21||r<1e-99)return this.mod.copyString(t,e,""),this.mod.mem32[o]=0,1;let[n="",c=""]=r.toFixed(s).split(".");"0"==n&&(n=""),n.length>0?(a=n.length,i=n+c):a=(i=c.replace(/^0+/,"")).length-c.length}}else i="1#INF00000000000000000000000000000".slice(0,s+1),a=1;return e-1<i.length?1:(this.mod.copyString(t,e,i),this.mod.setLong(o,a),this.mod.setLong(n,l),0)}}class i{decoderUTF8=new TextDecoder("utf-8");decoder1252=new TextDecoder("windows-1252");convert(t,e){let r;if(65001==e)r=this.decoderUTF8.decode(new Uint8Array([t]),{stream:!0});else if(1252==e)r=this.decoder1252.decode(new Uint8Array([t]));else if(0==e)r=t>127?"":String.fromCharCode(t);else if(12e3==e)r=String.fromCodePoint(t);else throw Error("unsupported CodePage: "+e);return r.codePointAt(0)||0}}let a=new i;function l(t,e,r){return function(t,e,r,s){let o=t.stringToU8(r,s);return t.mem8.set(o,e),o.length}(this,t,String.fromCodePoint(e),r)}function c(){return w(this,navigator.language,0)}function h(t,e){let r=RegExp(this.getString(t),"u"),s=a.decoder1252.decode(new Uint8Array([e]));return r.test(s)?1:0}function u(t){if(8239==t.codePointAt(0))return 32;let e=t.codePointAt(0)||0;switch(e){case 338:return 140;case 339:return 156;case 352:return 138;case 353:return 154;case 376:return 159;case 381:return 142;case 382:return 158;case 402:return 131;case 710:return 136}switch(t.normalize()){case"€":return 128;case"‚":return 130;case"ƒ":return 131;case"„":return 132;case"…":return 133;case"†":return 134;case"‡":return 135;case"ˆ":return 136;case"‰":return 137;case"Š":return 138;case"‹":return 139;case"Œ":return 140;case"Ž":return 142;case"‘":return 145;case"’":return 146;case"“":return 147;case"”":return 148;case"•":return 149;case"–":return 150;case"—":return 151;case"˜":return 152;case"™":return 153;case"š":return 154;case"›":return 155;case"œ":return 156;case"ž":return 158;case"Ÿ":return 159}return e>255&&(console.log("twr-wasm.to1252(): unable to convert: ",t,e),e=0),e}function d(t){let e=a.decoder1252.decode(new Uint8Array([t]));return RegExp("^\\p{Letter}$","u").test(e)?u(e.toLocaleLowerCase()):t}function m(t){let e=a.decoder1252.decode(new Uint8Array([t]));return 402==e.codePointAt(0)||181==e.codePointAt(0)||223==e.codePointAt(0)||"µ"==e||"ƒ"==e||"ß"==e?t:RegExp("^\\p{Letter}$","u").test(e)?u(e.toLocaleUpperCase()):t}function f(t,e,r){let s=this.getString(t,void 0,r),o=this.getString(e,void 0,r);return new Intl.Collator().compare(s,o)}function g(t,e){let r=new Date(1e3*e);this.setLong(t,r.getSeconds()),this.setLong(t+4,r.getMinutes()),this.setLong(t+8,r.getHours()),this.setLong(t+12,r.getDate()),this.setLong(t+16,r.getMonth()),this.setLong(t+20,r.getFullYear()-1900),this.setLong(t+24,r.getDay()),this.setLong(t+28,function(t){let e=new Date(t.getFullYear(),0,1);return Math.floor((t.getTime()-e.getTime())/864e5)}(r)),this.setLong(t+32,new Date().toLocaleTimeString("en-US",{timeZoneName:"long"}).includes("Daylight")?1:0),this.setLong(t+36,-(60*r.getTimezoneOffset())),this.setLong(t+40,w(this,r.toLocaleTimeString("en-US",{timeZoneName:"short"}).split(" ").pop()||"UTC",0))}function D(t,e,r,s){let o=w(t,r,s);t.setLong(e,o)}function w(t,e,r){let s=t.stringToU8(e,r),o=(0,t.exports.malloc)(s.length+1);return t.mem8.set(s,o),t.mem8[o+s.length]=0,o}function E(t,e){let r=new Intl.NumberFormat().format(1.1).replace(/[0-9]/g,"").charAt(0),s=new Intl.NumberFormat(void 0,{minimumFractionDigits:0}).format(1e3).replace(/[0-9]/g,"").charAt(0);D(this,t+0,r,e),D(this,t+4,s,e),D(this,t+20,r,e),D(this,t+24,s,e),D(this,t+24,s,e),D(this,t+24,s,e),D(this,t+32,"+",e),D(this,t+36,"-",e),D(this,t+12,p(),e),D(this,t+16,p(),e)}function p(){switch(navigator.language){case"en-US":case"en-CA":case"fr-CA":case"en-AU":case"es-MX":case"es-AR":case"es-CL":case"es-CO":case"es-EC":case"en-GY":case"nl-SR":case"es-UY":case"en-BZ":case"es-SV":case"es-PA":return"$";case"es-BO":case"es-VE":return"Bs.";case"es-PY":return"₲";case"es-PE":return"S/";case"es-CR":return"₡";case"es-GT":return"Q";case"es-HN":return"L";case"es-NI":return"C$";case"en-GB":return"£";case"en-IE":case"de-DE":case"fr-FR":case"de-AT":case"nl-BE":case"fr-BE":case"el-CY":case"et-EE":case"fi-FI":case"sv-FI":case"el-GR":case"it-IT":case"lv-LV":case"lt-LT":case"fr-LU":case"de-LU":case"lb-LU":case"mt-MT":case"nl-NL":case"pt-PT":case"sk-SK":case"sl-SI":case"es-ES":return"€";case"ja-JP":case"zh-CN":return"¥";case"de-CH":case"fr-CH":case"it-CH":return"CHF";case"sv-SE":case"da-DK":case"nb-NO":return"kr";case"ru-RU":return"₽";case"ko-KR":return"₩";case"en-IN":return"₹";case"pt-BR":return"R$";case"he-IL":return"₪";case"tr-TR":return"₺";default:return""}}function T(t){let e=(0,this.exports.malloc)(160);for(let r=0;r<7;r++)D(this,e+4*r,A(r,"long"),t);for(let r=0;r<7;r++)D(this,e+(r+7)*4,A(r,"short"),t);for(let r=0;r<12;r++)D(this,e+(r+14)*4,y(r,"long"),t);for(let r=0;r<12;r++)D(this,e+(r+14+12)*4,y(r,"short"),t);return D(this,e+152,function(){let t=new Date(2e3,0,1,9,0,0),e=new Intl.DateTimeFormat(void 0,{hour:"numeric",hour12:!0}).formatToParts(t).find(t=>"dayPeriod"===t.type);return e?e.value:""}(),t),D(this,e+156,function(){let t=new Date(2e3,0,1,15,0,0),e=new Intl.DateTimeFormat(void 0,{hour:"numeric",hour12:!0}).formatToParts(t).find(t=>"dayPeriod"===t.type);return e?e.value:""}(),t),e}function A(t,e){let r=new Date;return r.setDate(r.getDate()-r.getDay()+t),new Intl.DateTimeFormat(void 0,{weekday:e}).format(r)}function y(t,e){let r=new Intl.DateTimeFormat(void 0,{month:e}),s=new Date(2e3,t,1);return r.format(s)}class S{memory;mem8;mem32;memD;exports;isAsyncProxy=!1;floatUtil;constructor(){this.mem8=new Uint8Array,this.mem32=new Uint32Array,this.memD=new Float64Array,this.floatUtil=new n(this)}async loadWasm(t,e,r){let s;try{s=await fetch(t)}catch(e){throw console.log("loadWasm() failed to fetch: "+t),e}if(!s.ok)throw Error("fetch response error on file '"+t+"'\n"+s.statusText);try{let t=await s.arrayBuffer(),o=await WebAssembly.instantiate(t,{env:e});if(this.exports=o.instance.exports,!this.exports)throw Error("Unexpected error - undefined instance.exports");if(this.memory)throw Error("unexpected error -- this.memory already set");if(this.memory=this.exports.memory,!this.memory)throw Error("Unexpected error - undefined exports.memory");this.mem8=new Uint8Array(this.memory.buffer),this.mem32=new Uint32Array(this.memory.buffer),this.memD=new Float64Array(this.memory.buffer),this.isAsyncProxy?(this.memory.buffer instanceof ArrayBuffer&&console.log("twrWasmModuleAsync requires shared Memory. Add wasm-ld --shared-memory --no-check-features (see docs)"),postMessage(["setmemory",this.memory])):this.memory.buffer instanceof ArrayBuffer||console.log("twrWasmModule does not require shared Memory. Okay to remove wasm-ld --shared-memory --no-check-features"),this.malloc=t=>new Promise(e=>{let r=this.exports.malloc;e(r(t))}),this.init(r)}catch(t){throw console.log("Wasm instantiate error: "+t+(t.stack?"\n"+t.stack:"")),t}}init(t){(0,this.exports.twr_wasm_init)(t.stdio,t.stderr,void 0==t.std2d?-1:t.std2d,this.mem8.length)}async callC(t){let e=await this.preCallC(t),r=await this.callCImpl(t[0],e);return await this.postCallC(e,t),r}async callCImpl(t,e=[]){if(!this.exports)throw Error("this.exports undefined");if(!this.exports[t])throw Error("callC: function '"+t+"' not in export table.  Use --export wasm-ld flag.");return(0,this.exports[t])(...e)}async preCallC(t){if(t.constructor!==Array)throw Error("callC: params must be array, first arg is function name");if(0==t.length)throw Error("callC: missing function name");let e=[],r=0;for(let s=1;s<t.length;s++){let o=t[s];switch(typeof o){case"number":case"bigint":e[r++]=o;break;case"string":e[r++]=await this.putString(o);break;case"object":if(o instanceof URL){let t=await this.fetchAndPutURL(o);e[r++]=t[0],e[r++]=t[1];break}if(o instanceof ArrayBuffer){let t=await this.putArrayBuffer(o);e[r++]=t;break}default:throw Error("callC: invalid object type passed in")}}return e}async postCallC(t,e){let r=0;for(let s=1;s<e.length;s++){let o=e[s];switch(typeof o){case"number":case"bigint":r++;break;case"string":await this.callCImpl("free",[t[r]]),r++;break;case"object":if(o instanceof URL){await this.callCImpl("free",[t[r]]),r+=2;break}if(o instanceof ArrayBuffer){let e=new Uint8Array(o),s=t[r];for(let t=0;t<e.length;t++)e[t]=this.mem8[s+t];await this.callCImpl("free",[s]),r++;break}throw Error("postCallC: internal error A");default:throw Error("postCallC: internal error B")}}return t}stringToU8(t,e=65001){let r;if(65001==e)r=new TextEncoder().encode(t);else if(1252==e){r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=u(t[e])}else if(0==e){r=new Uint8Array(t.length);for(let e=0;e<t.length;e++){let s=function(t){if("ƒ"==t)return 102;if(8239==t.codePointAt(0))return 32;let e=t.codePointAt(0)||0;return e>127?63:e}(t[e]);r[e]=s}}else throw Error("unknown codePage: "+e);return r}copyString(t,e,r,s=65001){let o;if(e<1)throw Error("copyString buffer_size must have length > 0 (room for terminating 0): "+e);let n=this.stringToU8(r,s);for(o=0;o<n.length&&o<e-1;o++)this.mem8[t+o]=n[o];this.mem8[t+o]=0}async putString(t,e=65001){let r=this.stringToU8(t,e),s=await this.malloc(r.length+1);return this.mem8.set(r,s),this.mem8[s+r.length]=0,s}async putU8(t){let e=await this.malloc(t.length);return this.mem8.set(t,e),e}async putArrayBuffer(t){let e=new Uint8Array(t);return this.putU8(e)}async fetchAndPutURL(t){if(!("object"==typeof t&&t instanceof URL))throw Error("fetchAndPutURL param must be URL");try{let e=await fetch(t),r=await e.arrayBuffer(),s=new Uint8Array(r);return[await this.putU8(s),s.length]}catch(e){throw console.log("fetchAndPutURL Error. URL: "+t+"\n"+e+(e.stack?"\n"+e.stack:"")),e}}getLong(t){let e=Math.floor(t/4);if(4*e!=t)throw Error("getLong passed non long aligned address");if(e<0||e>=this.mem32.length)throw Error("invalid index passed to getLong: "+t+", this.mem32.length: "+this.mem32.length);return this.mem32[e]}setLong(t,e){let r=Math.floor(t/4);if(4*r!=t)throw Error("setLong passed non long aligned address");if(r<0||r>=this.mem32.length-1)throw Error("invalid index passed to setLong: "+t+", this.mem32.length: "+this.mem32.length);this.mem32[r]=e}getDouble(t){let e=Math.floor(t/8);if(8*e!=t)throw Error("getLong passed non Float64 aligned address");return this.memD[e]}setDouble(t,e){let r=Math.floor(t/8);if(8*r!=t)throw Error("setDouble passed non Float64 aligned address");this.memD[r]=e}getShort(t){if(t<0||t>=this.mem8.length)throw Error("invalid index passed to getShort: "+t);return this.mem8[t]+256*this.mem8[t+1]}getString(t,e,r=65001){let s;if(t<0||t>=this.mem8.length)throw Error("invalid strIndex passed to getString: "+t);if(e){if(e<0||e+t>this.mem8.length)throw Error("invalid len  passed to getString: "+e)}else{if(-1==(e=this.mem8.indexOf(0,t)))throw Error("string is not null terminated");e-=t}if(65001==r)s="utf-8";else if(1252==r)s="windows-1252";else throw Error("Unsupported codePage: "+r);let o=new TextDecoder(s),n=new Uint8Array(this.mem8.buffer,t,e);if(this.mem8.buffer instanceof ArrayBuffer)return o.decode(n);{let t=new Uint8Array(new ArrayBuffer(e));return t.set(n),o.decode(t)}}getU8Arr(t){if(t<0||t>=this.mem8.length)throw Error("invalid index passed to getU8: "+t);let e=new Uint32Array(this.mem8.slice(t,t+8).buffer),r=e[0],s=e[1];if(s<0||s>=this.mem8.length)throw Error("invalid idx.dataptr passed to getU8");if(r<0||r>this.mem8.length-s)throw Error("invalid idx.size passed to  getU8");return this.mem8.slice(s,s+r)}getU32Arr(t){if(t<0||t>=this.mem8.length)throw Error("invalid index passed to getU32: "+t);let e=new Uint32Array(this.mem8.slice(t,t+8).buffer),r=e[0],s=e[1];if(s<0||s>=this.mem8.length)throw Error("invalid idx.dataptr passed to getU32");if(r<0||r>this.mem8.length-s)throw Error("invalid idx.size passed to  getU32");if(r%4!=0)throw Error("idx.size is not an integer number of 32 bit words");return new Uint32Array(this.mem8.slice(s,s+r).buffer)}}function C(){return Date.now()}class I{sharedArray;buf;constructor(t){if("undefined"!=typeof window&&!crossOriginIsolated&&"file:"!==window.location.protocol)throw Error("twrSharedCircularBuffer constructor, crossOriginIsolated="+crossOriginIsolated+". See SharedArrayBuffer docs.");t?this.sharedArray=t:this.sharedArray=new SharedArrayBuffer(1032),this.buf=new Int32Array(this.sharedArray),this.buf[256]=0,this.buf[257]=0}write(t){let e=this.buf[257];this.buf[e]=t,256==++e&&(e=0),this.buf[257]=e,Atomics.notify(this.buf,257)}read(){if(this.isEmpty())return -1;{let t=this.buf[256],e=this.buf[t];return t++,this.buf[256]=t,e}}readWait(){if(this.isEmpty()){let t=this.buf[256];Atomics.wait(this.buf,257,t)}return this.read()}isEmpty(){return this.buf[256]==this.buf[257]}}class L{static CHARREAD=1;static CHARWRITE=2;static ADDRESSABLE_DISPLAY=4;static CANVAS2D=8;static EVENTS=16;constructor(){}}class R{static consoles=[];static registerConsole(t){return R.consoles.push(t),R.consoles.length-1}static getConsole(t){if(t<0||t>=R.consoles.length)throw Error("Invalid console ID: "+t);return R.consoles[t]}static getConsoleID(t){for(let e=0;e<R.consoles.length;e++)if(R.consoles[e]==t)return e;throw Error("IConsole not in registry")}}class b{static consoles=[];static registerConsoleProxy(t){return b.consoles[t.id]=t,t.id}static getConsoleProxy(t){if(t<0||t>=b.consoles.length)throw Error("Invalid console ID: "+t);return b.consoles[t]}static getConsoleID(t){for(let e=0;e<b.consoles.length;e++)if(b.consoles[e]==t)return e;throw Error("IConsoleProxy not in registry")}}class _{keys;id;constructor(t){let[e,r,s]=t;this.keys=new I(s),this.id=r}charIn(){return this.keys.readWait()}inkey(){return this.keys.isEmpty()?0:this.charIn()}charOut(t,e){postMessage(["div-charout",[this.id,t,e]])}putStr(t){postMessage(["div-putstr",[this.id,t]])}getProp(t){return"type"===t?L.CHARWRITE|L.CHARREAD:(console.log("twrConsoleDivProxy.getProp passed unknown property name: ",t),0)}setFocus(){postMessage(["div-focus",[this.id]])}}(r=t||(t={}))[r.WAITING=0]="WAITING",r[r.SIGNALED=1]="SIGNALED";class U{sharedArray;buf;constructor(e){if("undefined"!=typeof window&&!crossOriginIsolated&&"file:"!==window.location.protocol)throw Error("twrSignal constructor, crossOriginIsolated="+crossOriginIsolated+". See SharedArrayBuffer docs.");e?this.sharedArray=e:this.sharedArray=new SharedArrayBuffer(4),this.buf=new Int32Array(this.sharedArray),this.buf[0]=t.WAITING}signal(){this.buf[0]=t.SIGNALED,Atomics.notify(this.buf,0)}wait(){this.buf[0]==t.WAITING&&Atomics.wait(this.buf,0,t.WAITING)}isSignaled(){return this.buf[0]==t.SIGNALED}reset(){this.buf[0]=t.WAITING}}class N{callCompleteSignal;parameters;constructor(t){this.callCompleteSignal=new U(t[0]),this.parameters=new Uint32Array(t[1])}sleep(t){this.callCompleteSignal.reset(),postMessage(["sleep",[t]]),this.callCompleteSignal.wait()}}(s=e||(e={}))[s.D2D_FILLRECT=1]="D2D_FILLRECT",s[s.D2D_FILLCODEPOINT=5]="D2D_FILLCODEPOINT",s[s.D2D_SETLINEWIDTH=10]="D2D_SETLINEWIDTH",s[s.D2D_SETFILLSTYLERGBA=11]="D2D_SETFILLSTYLERGBA",s[s.D2D_SETFONT=12]="D2D_SETFONT",s[s.D2D_BEGINPATH=13]="D2D_BEGINPATH",s[s.D2D_MOVETO=14]="D2D_MOVETO",s[s.D2D_LINETO=15]="D2D_LINETO",s[s.D2D_FILL=16]="D2D_FILL",s[s.D2D_STROKE=17]="D2D_STROKE",s[s.D2D_SETSTROKESTYLERGBA=18]="D2D_SETSTROKESTYLERGBA",s[s.D2D_ARC=19]="D2D_ARC",s[s.D2D_STROKERECT=20]="D2D_STROKERECT",s[s.D2D_FILLTEXT=21]="D2D_FILLTEXT",s[s.D2D_IMAGEDATA=22]="D2D_IMAGEDATA",s[s.D2D_PUTIMAGEDATA=23]="D2D_PUTIMAGEDATA",s[s.D2D_BEZIERTO=24]="D2D_BEZIERTO",s[s.D2D_MEASURETEXT=25]="D2D_MEASURETEXT",s[s.D2D_SAVE=26]="D2D_SAVE",s[s.D2D_RESTORE=27]="D2D_RESTORE",s[s.D2D_CREATERADIALGRADIENT=28]="D2D_CREATERADIALGRADIENT",s[s.D2D_SETCOLORSTOP=29]="D2D_SETCOLORSTOP",s[s.D2D_SETFILLSTYLEGRADIENT=30]="D2D_SETFILLSTYLEGRADIENT",s[s.D2D_RELEASEID=31]="D2D_RELEASEID",s[s.D2D_CREATELINEARGRADIENT=32]="D2D_CREATELINEARGRADIENT",s[s.D2D_SETFILLSTYLE=33]="D2D_SETFILLSTYLE",s[s.D2D_SETSTROKESTYLE=34]="D2D_SETSTROKESTYLE",s[s.D2D_CLOSEPATH=35]="D2D_CLOSEPATH",s[s.D2D_RESET=36]="D2D_RESET",s[s.D2D_CLEARRECT=37]="D2D_CLEARRECT",s[s.D2D_SCALE=38]="D2D_SCALE",s[s.D2D_TRANSLATE=39]="D2D_TRANSLATE",s[s.D2D_ROTATE=40]="D2D_ROTATE",s[s.D2D_GETTRANSFORM=41]="D2D_GETTRANSFORM",s[s.D2D_SETTRANSFORM=42]="D2D_SETTRANSFORM",s[s.D2D_RESETTRANSFORM=43]="D2D_RESETTRANSFORM",s[s.D2D_STROKETEXT=44]="D2D_STROKETEXT",s[s.D2D_ROUNDRECT=45]="D2D_ROUNDRECT",s[s.D2D_ELLIPSE=46]="D2D_ELLIPSE",s[s.D2D_QUADRATICCURVETO=47]="D2D_QUADRATICCURVETO",s[s.D2D_SETLINEDASH=48]="D2D_SETLINEDASH",s[s.D2D_GETLINEDASH=49]="D2D_GETLINEDASH",s[s.D2D_ARCTO=50]="D2D_ARCTO",s[s.D2D_GETLINEDASHLENGTH=51]="D2D_GETLINEDASHLENGTH";class P{canvasKeys;drawCompleteSignal;props;id;constructor(t){let[e,r,s,o,n]=t;this.drawCompleteSignal=new U(o),this.canvasKeys=new I(n),this.props=s,this.id=r}charIn(){return this.canvasKeys.readWait()}inkey(){return this.canvasKeys.isEmpty()?0:this.charIn()}getProp(t){return this.props[t]}drawSeq(t){this.drawCompleteSignal.reset(),postMessage(["canvas2d-drawseq",[this.id,t]]),this.drawCompleteSignal.wait()}}class x{id;constructor(t){this.id=t[1]}charIn(){return 0}setFocus(){}charOut(t,e){postMessage(["debug-charout",[this.id,t,e]])}putStr(t){postMessage(["debug-putstr",[this.id,t]])}getProp(t){return"type"===t?L.CHARWRITE:(console.log("twrConsoleDebugProxy.getProp passed unknown property name: ",t),0)}}class F{keys;returnValue;id;constructor(t){let[e,r,s,o]=t;this.keys=new I(o),this.returnValue=new I(s),this.id=r}getProp(t){return postMessage(["term-getprop",[this.id,t]]),this.returnValue.readWait()}charIn(){return this.keys.readWait()}point(t,e){return postMessage(["term-point",[this.id,t,e]]),0!=this.returnValue.readWait()}charOut(t,e){postMessage(["term-charout",[this.id,t,e]])}putStr(t){postMessage(["term-putstr",[this.id,t]])}cls(){postMessage(["term-cls",[this.id]])}setRange(t,e){postMessage(["term-setrange",[this.id,t,e]])}setC32(t,e){postMessage(["term-setc32",[this.id,t,e]])}setReset(t,e,r){postMessage(["term-setreset",[this.id,t,e,r]])}setCursor(t){postMessage(["term-setcursor",[this.id,t]])}setCursorXY(t,e){postMessage(["term-setcursorxy",[this.id,t,e]])}setColors(t,e){postMessage(["term-setcolors",[this.id,t,e]])}setFocus(){postMessage(["term-focus",[this.id]])}}self.onmessage=function(t){if("startup"==t.data[0]){let e=t.data[1];(o=new O(e.allProxyParams)).loadWasm(e.urlToLoad).then(()=>{postMessage(["startupOkay"])}).catch(t=>{console.log(".catch: ",t),postMessage(["startupFail",t])})}else"callC"==t.data[0]?o.callCImpl(t.data[1],t.data[2]).then(t=>{postMessage(["callCOkay",t])}).catch(e=>{console.log("exception in callC in 'twrmodasyncproxy.js': \n",t.data[1],t.data[2]),console.log(e),postMessage(["callCFail",e])}):console.log("twrmodasyncproxy.js: unknown message: "+t)};class O extends S{malloc;imports;ioNamesToID;cpTranslate;getProxyInstance(t){let e=t[0];switch(e){case"twrConsoleDivProxy":return new _(t);case"twrConsoleTerminalProxy":return new F(t);case"twrConsoleDebugProxy":return new x(t);case"twrConsoleCanvasProxy":return new P(t);default:throw Error("Unknown class name passed to getProxyClassConstructor: "+e)}}constructor(t){super(),this.isAsyncProxy=!0,this.malloc=t=>{throw Error("error - un-init malloc called")},this.cpTranslate=new i,this.ioNamesToID=t.ioNamesToID;for(let e=0;e<t.conProxyParams.length;e++){let r=t.conProxyParams[e],s=this.getProxyInstance(r);b.registerConsoleProxy(s)}let e=new N(t.waitingCallsProxyParams),r=(t,e,...r)=>{let s=b.getConsoleProxy(e),o=s[t];if(!o)throw Error(`Likely using an incorrect console type. jsid=${e}, funcName=${t}`);return o.call(s,...r)};this.imports={twrTimeEpoch:C,twrTimeTmLocal:g.bind(this),twrUserLconv:E.bind(this),twrUserLanguage:c.bind(this),twrRegExpTest1252:h.bind(this),twrToLower1252:d.bind(this),twrToUpper1252:m.bind(this),twrStrcoll:f.bind(this),twrUnicodeCodePointToCodePage:l.bind(this),twrCodePageToUnicodeCodePoint:this.cpTranslate.convert.bind(this.cpTranslate),twrGetDtnames:T.bind(this),twrGetConIDFromName:t=>{let e=this.getString(t);return this.ioNamesToID[e]||-1},twrSleep:e.sleep.bind(e),twrConCharOut:r.bind(null,"charOut"),twrConCharIn:r.bind(null,"charIn"),twrSetFocus:r.bind(null,"setFocus"),twrConGetProp:(t,e)=>r("getProp",t,this.getString(e)),twrConCls:r.bind(null,"cls"),twrConSetC32:r.bind(null,"setC32"),twrConSetReset:r.bind(null,"setReset"),twrConPoint:r.bind(null,"point"),twrConSetCursor:r.bind(null,"setCursor"),twrConSetColors:r.bind(null,"setColors"),twrConSetRange:(t,e,s,o)=>{let n=[];for(let t=s;t<s+o;t++)n.push(this.getLong(t));r("setRange",t,s,n)},twrConPutStr:(t,e,s)=>{r("putStr",t,this.getString(e),s)},twrConDrawSeq:(t,e)=>{r("drawSeq",t,e,this)},twrSin:Math.sin,twrCos:Math.cos,twrTan:Math.tan,twrFAbs:Math.abs,twrACos:Math.acos,twrASin:Math.asin,twrATan:Math.atan,twrExp:Math.exp,twrFloor:Math.floor,twrCeil:Math.ceil,twrFMod:function(t,e){return t%e},twrLog:Math.log,twrPow:Math.pow,twrSqrt:Math.sqrt,twrTrunc:Math.trunc,twrDtoa:this.floatUtil.dtoa.bind(this.floatUtil),twrToFixed:this.floatUtil.toFixed.bind(this.floatUtil),twrToExponential:this.floatUtil.toExponential.bind(this.floatUtil),twrAtod:this.floatUtil.atod.bind(this.floatUtil),twrFcvtS:this.floatUtil.fcvtS.bind(this.floatUtil)}}async loadWasm(t){return super.loadWasm(t,this.imports,this.ioNamesToID)}}})();
//# sourceMappingURL=twrmodasyncproxy.c3081bc6.js.map
